<!DOCTYPE html>
<html>
<head>
<title>XRX++ Benchmark Tests - xrx.pilot</title>
<script src='../../lib/closure-library/closure/goog/base.js'></script>
<link rel="stylesheet" type="text/css" 
    href="../../lib/closure-library/closure/goog/testing/performancetable.css" />
<script type="text/javascript" src="../../lib/jssaxparser/LocatorImpls.js"></script>
<script type="text/javascript" src="../../lib/jssaxparser/NamespaceSupport.js"></script>
<script type="text/javascript" src="../../lib/jssaxparser/sax.js"></script>
<script type="text/javascript" src="../../lib/jssaxparser/DefaultHandlers.js"></script>
<script src='../../src/deps.js'></script>
<script src='./pilot_bench.js'></script>
<script type="text/javascript">  
  goog.require('goog.net.XhrIo');
  goog.require('goog.testing.PerformanceTable');
  goog.require('goog.testing.jsunit');
  goog.require('goog.userAgent.product');
  goog.require('xrx.pilot');
  goog.require('xrx.label');
  goog.require('xrx.parse');
</script>

<script>
  if (goog.userAgent.product.CHROME &&
      window.location.toString().indexOf('file:') == 0) {
    document.write(
        '<div class="warning">' +
        'WARNING: Due to Chrome\'s security restrictions ' +
        'this test will not be able to load files off your local disk ' +
        'unless you start Chrome with:<br>' +
        '<code>--allow-file-access-from-files</code></div><br>');
  }
</script>

</head>
<body>
<div id="perfTable"></div>
<script type="text/javascript">

var table = new goog.testing.PerformanceTable(
    goog.dom.getElement('perfTable'));

function test01Forward() {
  var request = new goog.net.XhrIo();
  var xml;

  goog.events.listen(request, 'complete', function() {
    xml = request.getResponseText();
    var parser = new xrx.parse();
    xml = parser.normalize(xml);

    table.run(
        goog.partial(pilotForward, xml),
          'Forward hamlet.xml (384kb)');
  });

  request.send('../../data/hamlet.xml.txt', 'GET');
};

function test02Backward() {
  var request = new goog.net.XhrIo();
  var xml;

  goog.events.listen(request, 'complete', function() {
    xml = request.getResponseText();
    var parser = new xrx.parse();
    xml = parser.normalize(xml);
    var label = new xrx.label([1]);
    var tok = new xrx.token.EndTag(label);
    var pilot = new xrx.pilot(xml);
    tok = pilot.forward(null, tok);

    table.run(
        goog.partial(pilotBackward, xml, tok),
          'Backward hamlet.xml (384kb)');
  });

  request.send('../../data/hamlet.xml.txt', 'GET');
};

</script>
</body>
</html>



