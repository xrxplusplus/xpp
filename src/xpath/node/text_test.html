<!DOCTYPE html>
<html>
<head>
<title>XRX++ Unit Tests - xrx.node.Text, xrx.node.TextS, xrx.node.TextB</title>
<script src='../../../lib/closure-library/closure/goog/base.js'></script>
<script src='../../deps.js'></script>
<script type="text/javascript">
  goog.require('goog.dom');
  goog.require('goog.testing.jsunit');
  goog.require('xrx.instance');
  goog.require('xrx.node.Element');
  goog.require('xrx.node.ElementS');
  goog.require('xrx.node.ElementB');
  goog.require('xrx.node.Text');
  goog.require('xrx.node.TextS');
  goog.require('xrx.node.TextB');
  goog.require('xrx.xpath');
  goog.require('xrx.xpath.NameTest');
  goog.require('xrx.xpath.KindTest');
</script>
</head>
<body>

<script type="text/javascript">

function test01nameFunctions() {
  // always ''
};

function test02identityFunctions() {
  var xml = '<a>1<b/>2<c id="test">3</c>4</a>';
  var element = goog.dom.createElement('div');
  goog.dom.setTextContent(element, xml);
  var instance = new xrx.instance(element);

  var e = new xrx.node.ElementB(instance, 1);
  var t = new xrx.node.TextB(instance, 1);

  // important!
  var t2 = new xrx.node.TextB(instance, 2); // [1,2,0]
  var t3 = new xrx.node.TextB(instance, 3); // [1,2]

  assertEquals(true, t.isSameAs(t));
  assertEquals(true, t.isAfter(e));
  assertEquals(true, e.isBefore(t));

  // important!
  assertTrue(t2.isBefore(t3));
  assertTrue(t3.isAfter(t2));
};

function test03contentFunctions() {
  var xml = '<a>1<b>2</b>3<c/>4<d/></a>';
  var element = goog.dom.createElement('div');
  goog.dom.setTextContent(element, xml);
  var instance = new xrx.instance(element);

  var t1 = new xrx.node.TextB(instance, 0);
  var t2 = new xrx.node.TextB(instance, 1);
  var t3 = new xrx.node.TextB(instance, 2);
  var t4 = new xrx.node.TextB(instance, 3);

  assertEquals('1', t1.getXml());
  assertEquals('2', t2.getXml());
  assertEquals('3', t3.getStringValue());
  assertEquals('4', t4.getStringValue());
};

function axisTest(key, func, expected) {
  var xml = '<a>1<b>2</b>3<c/>4<d>t<e type="attrValue">5</e>6</d><d id="test"/></a>';
  var element = goog.dom.createElement('div');
  goog.dom.setTextContent(element, xml);
  var instance = new xrx.instance(element);
  var t = new xrx.node.TextB(instance, key);
  var test = {
    node: t[func](new xrx.xpath.KindTest('node')),
    //element: t[func](new xrx.xpath.NameTest('*')),
    //text: t[func](new xrx.xpath.KindTest('text')),
    //attribute: t[func](new xrx.xpath.NameTest('@*'))
  }

  assertEquals(expected.node, test.node.getLength());
  //assertEquals(expected.element, test.element.getLength());
  //assertEquals(expected.text, test.text.getLength());
  //assertEquals(expected.attribute, test.attribute.getLength());
};


function test04nodeFunctions() {

  // ancestor
  //axisTest(5, 'getNodeAncestor', { node: 4, element: 3, text: 0, attribute: 0 });

  // child
  //axisTest(0, 'getNodeChild', { node: 0, element: 0, text: 0, attribute: 0 });

  // descendant
  //axisTest(0, 'getNodeDescendant', { node: 0, element: 0, text: 0, attribute: 0 });

  // following
  axisTest(2, 'getNodeFollowing', { node: 8, element: 4, text: 4, attribute: 0 });

  // following sibling
  //axisTest(2, 'getNodeFollowingSibling', { node: 4, element: 3, text: 1, attribute: 0 });

  // parent
  //axisTest(6, 'getNodeParent', { node: 1, element: 1, text: 0, attribute: 0 });

  // preceding
  //axisTest(6, 'getNodePreceding', { node: 9, element: 3, text: 6, attribute: 0 });

  // preceding sibling
  //axisTest(2, 'getNodePrecedingSibling', { node: 6, element: 3, text: 3, attribute: 0 });

};

</script>
</body>
</html>

